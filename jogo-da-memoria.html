<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo da Memória</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            background-color: #f0f0f0;
            color: #333;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .btn, .menu-item.clickable {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }
       
        .btn:hover, .menu-item.clickable:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        .back-button, .exit-button {
            padding: 10px 20px;
            background-color: #b0b0b0;
            color: #fff;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: none;
        }

        .back-button:hover, .exit-button:hover {
            background-color: #a0a0a0;
        }

        .exit-button {
            margin-right: 10px;
        }

        .back-button-top {
            position: absolute;
            top: 20px;
            left: 20px;
        }

        @media (max-width: 480px) {
            .back-button, .exit-button {
                padding: 8px 15px;
                font-size: 0.9em;
            }
        }

        h1 {
            font-family: 'Montserrat', sans-serif;
            color: #555;
            font-size: 3em;
            margin-bottom: 20px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        #menu, #jogo {
            width: 90%;
            max-width: 500px;
            text-align: center;
        }

        .menu-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px;
            margin: 15px 0;
            font-size: 1.1em;
            cursor: default;
            border: none;
            border-radius: 12px;
            background-color: #e0e0e0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
       
        .menu-item .label {
            font-weight: 500;
            color: #777;
        }
       
        .menu-item .value {
            font-weight: bold;
            color: #444;
            flex-grow: 1;
            margin: 0 10px;
        }

        .menu-item .arrow-btn {
            background-color: #999;
            border: none;
            color: #fff;
            font-size: 1.2em;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
       
        .menu-item .arrow-btn:hover {
            background-color: #777;
            transform: translateY(-1px);
        }

        #iniciar-jogo, #ver-ranking {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            width: 100%;
            padding: 20px;
            margin-top: 30px;
            font-size: 1.3em;
            cursor: pointer;
            border: none;
            border-radius: 12px;
            background-color: #007bff;
            color: #fff;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        #iniciar-jogo:hover, #ver-ranking:hover {
            background-color: #0056b3;
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }

        #game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-top: 10px;
            font-size: 1.2em;
            font-weight: bold;
            color: #555;
        }

        #game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 500px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
       
        #placar-e-tempo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        #placar, #cronometro {
            font-size: 1.2em;
            font-weight: bold;
            color: #555;
            white-space: nowrap;
        }
       
        #turno-jogador {
            font-style: italic;
            color: #888;
        }

        .card-grid {
            display: grid;
            gap: 10px;
            margin-top: 20px;
        }
        .card {
            background-color: #555;
            border-radius: 10px;
            cursor: pointer;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.5s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .card.virada {
            transform: rotateY(180deg);
        }
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .card-back {
            background-color: #555;
            border-radius: 10px;
        }
        .card-front {
            transform: rotateY(180deg);
            border-radius: 10px;
        }
        .card-symbol {
            font-size: 2.2em;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        /* Div para fim de jogo */
        #fim-de-jogo {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            text-align: center;
            display: none;
        }
        #fim-de-jogo h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 3em;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        #fim-de-jogo p {
            color: #fff;
            font-size: 1.5em;
        }
        #voltar-menu {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            padding: 20px;
            font-size: 1.3em;
            cursor: pointer;
            border: none;
            border-radius: 12px;
            background-color: #007bff;
            color: #fff;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }
        #voltar-menu:hover {
            background-color: #0056b3;
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }

        /* Ranking overlay */
        #ranking {
            display:none;
            position:fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.7); color:#fff;
            display:flex; justify-content:center; align-items:center;
            flex-direction:column; padding:20px; overflow:auto; z-index:1000;
        }
        #ranking h2 {
            font-size:2.5em; margin-bottom:20px;
        }
        #ranking ol {
            text-align:left; font-size:1.2em;
        }
        #ranking button {
            margin-top:20px;
            padding:10px 20px;
            border:none;
            border-radius:8px;
            background-color:#007bff;
            color:white;
            font-weight:bold;
            cursor:pointer;
        }
    </style>
</head>
<body>
    <div id="menu">
        <a href="index.html" class="back-button btn back-button-top">Voltar ao Menu</a>
        <h1>Jogo da Memória</h1>
        <div class="menu-item clickable" onclick="alternarModoDeJogo()">
            <span class="label">Jogadores:</span>
            <span class="value" id="modo-de-jogo">Um Jogador</span>
        </div>
        <div class="menu-item">
            <span class="label">Nível:</span>
            <button class="arrow-btn btn" onclick="mudarDificuldade(-1)">&lt;</button>
            <span class="value" id="nivel">Fácil (4x4)</span>
            <button class="arrow-btn btn" onclick="mudarDificuldade(1)">&gt;</button>
        </div>
        <div class="menu-item">
            <span class="label">Cores:</span>
            <button class="arrow-btn btn" onclick="mudarModoDaltonismo(-1)">&lt;</button>
            <span class="value" id="modo-daltonismo">Normal</span>
            <button class="arrow-btn btn" onclick="mudarModoDaltonismo(1)">&gt;</button>
        </div>
        <div class="menu-item clickable" onclick="alternarModoSimbolos()">
            <span class="label">Modo:</span>
            <span class="value" id="modo-simbolos">Cores</span>
        </div>
        <button id="iniciar-jogo" class="btn" onclick="iniciarJogo()">INICIAR</button>
        <button id="ver-ranking" class="btn" onclick="mostrarRankingFirebase()">VER RANKING</button>
    </div>

    <div id="jogo" style="display:none;">
        <div id="game-header">
            <a href="index.html" class="exit-button btn">Sair</a>
            <div id="placar-e-tempo">
                <span id="placar">Pares Encontrados: 0</span>
                <span id="cronometro">Tempo: 00:00</span>
            </div>
        </div>
        <div id="game-info">
            <span id="turno-jogador"></span>
            <span id="placar-jogadores"></span>
        </div>
        <div class="card-grid" id="card-grid"></div>
    </div>

    <div id="fim-de-jogo">
        <h2>Fim de Jogo</h2>
        <p id="mensagem-final"></p>
        <a href="index.html" id="voltar-menu" class="btn">Voltar ao Menu</a>
    </div>

    <div id="ranking">
        <h2>Ranking Global</h2>
        <ol id="lista-ranking"></ol>
        <button onclick="document.getElementById('ranking').style.display='none'">Fechar</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";

        // Firebase config
        const firebaseConfig = {
            apiKey: "SUA_API_KEY",
            authDomain: "SEU_PROJETO.firebaseapp.com",
            projectId: "SEU_PROJETO",
            storageBucket: "SEU_PROJETO.appspot.com",
            messagingSenderId: "SEU_ID",
            appId: "SEU_APP_ID"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function salvarRankingFirebase(nome, pares, tempo) {
            try {
                await addDoc(collection(db, "rankingMemoria"), {
                    nome: nome,
                    pares: pares,
                    tempo: tempo,
                    data: new Date()
                });
                mostrarRankingFirebase();
            } catch(e) {
                console.error("Erro ao salvar ranking:", e);
            }
        }

        async function mostrarRankingFirebase() {
            const lista = document.getElementById('lista-ranking');
            lista.innerHTML = '';
            const q = query(collection(db, "rankingMemoria"), orderBy("pares", "desc"), limit(10));
            const querySnapshot = await getDocs(q);
            querySnapshot.forEach(doc => {
                const item = doc.data();
                const li = document.createElement('li');
                li.textContent = `Nome: ${item.nome} | Pares: ${item.pares} | Tempo: ${item.tempo}`;
                lista.appendChild(li);
            });
            document.getElementById('ranking').style.display = 'flex';
        }

        // --- Código do jogo continua igual ao que você enviou ---
        const cardGrid = document.getElementById('card-grid');
        const placarJogadores = document.getElementById('placar-jogadores');
        const turnoJogador = document.getElementById('turno-jogador');
        const placarUnico = document.getElementById('placar');
        const fimDeJogoDiv = document.getElementById('fim-de-jogo');
        const mensagemFinal = document.getElementById('mensagem-final');
        const menuDiv = document.getElementById('menu');
        const jogoDiv = document.getElementById('jogo');
        const cronometroElement = document.getElementById('cronometro');

        let timer; let segundos = 0;
        const niveis = {1:{nome:'Fácil (4x4)',cols:4,rows:4},2:{nome:'Médio (4x5)',cols:4,rows:5},3:{nome:'Difícil (5x6)',cols:5,rows:6},4:{nome:'Muito Difícil (6x6)',cols:6,rows:6}};
        const paletas = { 'Normal':['#ff0000','#00ff00','#0000ff','#ffff00','#800080','#00ffff','#ffa500','#ff00ff','#c0c0c0','#800000','#808000','#008000','#008080','#000080','#808080','#ff4500','#4b0082','#f5f5dc'], 'Protanopia':['#f06464','#64f064','#6464f0','#f0f064','#960096','#64f0f0','#f0aa00','#f000f0','#b0b0b0','#700000','#707000','#007000','#007070','#000070','#707070','#f04000','#3b0072','#e5e5c0'], 'Deuteranopia':['#f06464','#64f064','#6464f0','#f0f064','#960096','#64f0f0','#f0aa00','#f000f0','#b0b0b0','#700000','#707000','#007000','#007070','#000070','#707070','#f04000','#3b0072','#e5e5c0'], 'Tritanopia':['#f06464','#64f064','#6464f0','#f0f064','#960096','#64f0f0','#f0aa00','#f000f0','#b0b0b0','#700000','#707000','#007000','#007070','#000070','#707070','#f04000','#3b0072','#e5e5c0']};
        const simbolos = ['★','♥','♦','♠','♣','♦','▲','●','■','◎','◈','◇','⌘','⌫','⌥','⎋','⍟','⚙'];

        let cartas=[], cartasViradas=[], paresEncontrados=0, nivelAtual=1, modoDaltonismo='Normal', modoSimbolos=false, modoDeJogo='um_jogador', jogadorAtual=1, pontuacao={1:0,2:0};

        function mudarDificuldade(d){nivelAtual=Math.min(Math.max(1,nivelAtual+d),4);document.getElementById('nivel').innerText=niveis[nivelAtual].nome;}
        function mudarModoDaltonismo(d){const m=Object.keys(paletas); let i=m.indexOf(modoDaltonismo); i=(i+d+m.length)%m.length; modoDaltonismo=m[i]; document.getElementById('modo-daltonismo').innerText=modoDaltonismo;}
        function alternarModoDeJogo(){modoDeJogo=modoDeJogo==='um_jogador'?'dois_jogadores':'um_jogador';document.getElementById('modo-de-jogo').innerText=modoDeJogo==='um_jogador'?'Um Jogador':'Dois Jogadores';}
        function alternarModoSimbolos(){modoSimbolos=!modoSimbolos;document.getElementById('modo-simbolos').innerText=modoSimbolos?'Símbolos':'Cores';}

        function iniciarJogo(){
            menuDiv.style.display='none'; jogoDiv.style.display='block';
            iniciarCronometro();
            gerarCartas();
        }

        function gerarCartas(){
            cartas=[]; cartasViradas=[]; paresEncontrados=0; jogadorAtual=1; pontuacao={1:0,2:0}; cardGrid.innerHTML='';
            const cols=niveis[nivelAtual].cols, rows=niveis[nivelAtual].rows; const total=cols*rows;
            let listaValores=[];
            if(modoSimbolos){listaValores=simbolos.slice(0,total/2);}else{listaValores=paletas[modoDaltonismo].slice(0,total/2);}
            listaValores=listaValores.concat(listaValores); listaValores.sort(()=>Math.random()-0.5);
            cardGrid.style.gridTemplateColumns=`repeat(${cols}, 1fr)`;
            cardGrid.style.gridTemplateRows=`repeat(${rows}, 1fr)`;
            for(let i=0;i<total;i++){
                const carta=document.createElement('div'); carta.classList.add('card');
                carta.dataset.valor=listaValores[i];
                carta.innerHTML=`<div class="card-face card-front"><span class="card-symbol">${listaValores[i]}</span></div><div class="card-face card-back"></div>`;
                carta.addEventListener('click',()=>virarCarta(carta));
                cardGrid.appendChild(carta); cartas.push(carta);
            }
        }

        function virarCarta(c){
            if(cartasViradas.includes(c)||c.classList.contains('virada')) return;
            c.classList.add('virada'); cartasViradas.push(c);
            if(cartasViradas.length===2){
                setTimeout(verificarPar,500);
            }
        }

        function verificarPar(){
            const [c1,c2]=cartasViradas;
            if(c1.dataset.valor===c2.dataset.valor){
                paresEncontrados++;
                if(modoDeJogo==='dois_jogadores'){pontuacao[jogadorAtual]++; atualizarPlacar();}
            } else {
                c1.classList.remove('virada'); c2.classList.remove('virada');
                if(modoDeJogo==='dois_jogadores'){jogadorAtual=jogadorAtual===1?2:1; atualizarPlacar();}
            }
            cartasViradas=[]; placarUnico.innerText=`Pares Encontrados: ${paresEncontrados}`;
            if(paresEncontrados===cartas.length/2){anunciarFimDeJogo();}
        }

        function atualizarPlacar(){placarJogadores.innerText=`Jogador 1: ${pontuacao[1]} | Jogador 2: ${pontuacao[2]}`; turnoJogador.innerText=`É a vez do Jogador ${jogadorAtual}`;}

        function anunciarFimDeJogo(){
            let mensagem='';
            if(modoDeJogo==='dois_jogadores'){
                if(pontuacao[1]>pontuacao[2]) mensagem=`Parabéns, Jogador 1! Você venceu!`;
                else if(pontuacao[2]>pontuacao[1]) mensagem=`Parabéns, Jogador 2! Você venceu!`;
                else mensagem=`O jogo terminou em um empate!`;
                fimDeJogoDiv.style.display='flex'; mensagemFinal.innerText=mensagem;
            } else {
                const tempoFormatado=`${Math.floor(segundos/60).toString().padStart(2,'0')}:${(segundos%60).toString().padStart(2,'0')}`;
                mensagem=`Parabéns! Você completou o jogo em ${tempoFormatado}.`;
                fimDeJogoDiv.style.display='flex'; mensagemFinal.innerText=mensagem;
                const nomeJogador=prompt("Digite seu nome para o ranking:");
                if(nomeJogador){salvarRankingFirebase(nomeJogador,paresEncontrados,tempoFormatado);}
            }
        }

        function iniciarCronometro(){segundos=0; cronometroElement.innerText='Tempo: 00:00'; clearInterval(timer); timer=setInterval(()=>{segundos++; const m=Math.floor(segundos/60); const s=segundos%60; cronometroElement.innerText=`Tempo: ${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;},1000);}
    </script>
</body>
</html>
